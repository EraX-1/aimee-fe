# 必要データ一覧（2025年8月更新版）

## 1. 現在受け取り済みデータ

### バッチ2（配置情報取得エンジン）
1. **業務別ログイン人数**
   - ファイル: `KENPO_RWLOGIN_*.csv`
   - 内容: 各工程に何人いるか
   - 更新頻度: 2分間隔
   - ステータス: ✅ 完全カバー

2. **拠点別配置人数**
   - ファイル: `KENPO_RWLOGIN_LOCATION_*.csv`
   - 内容: 9拠点の配置状況と生産性
   - 更新頻度: 2分間隔
   - ステータス: ✅ 完全カバー

3. **処理状況**
   - ファイル: 
     - `KENPO_FS_*.csv`: 受付件数、納品済件数
     - `KENPO_RWMSGCOUNT_*.csv`: 工程別の未処理件数
     - `KENPO_NOTINPUT_*.csv`: 未投入件数
   - 更新頻度: 2分間隔
   - ステータス: ✅ 受取済み

### バッチ3（OP実績取得エンジン）
1. **拠点別生産性**
   - ファイル: `KENPO_RWLOGIN_LOCATION_*.csv`で完全カバー
   - ステータス: ✅ 完全カバー

2. **工程別未処理**
   - ファイル: `KENPO_RWMSGCOUNT_*.csv`で完全カバー
   - ステータス: ✅ 完全カバー

3. **業務量推移**
   - 2分間隔のCSVファイルで時系列データ完備
   - ステータス: ✅ 完全カバー

## 2. これから必要になるデータ ⭐ 2025年12月更新

### バッチ2（配置情報取得エンジン）
1. **個人別配置データ** ✅ 石田様よりデータ提供済み
   - 内容: 誰がどの工程・拠点にいるか
   - ファイル: `KENPO_LOGINNOW_YYYYMMDD_HHMM.csv`
   - 更新頻度: リアルタイム（2分間隔）
   - 含まれる項目:
     - オペレータID
     - オペレータ名
     - 現在の配置（業務ID、工程ID、拠点ID）
     - ログイン時刻
     - チームID（所属チーム）

2. **スキル情報** ✅ 石田様よりデータ提供済み
   - 内容: オペレータが処理可能な業務・工程の定義
   - ファイル: `oprprocessplan2.tsv`
   - 用途: オペレータはこのデータで定義した業務・工程のみ処理可能
   - 含まれる項目:
     - オペレータID
     - 業務ID
     - 工程ID
     - 処理可否フラグ
   - 注記: スキルレベル（初級/中級/上級）の区分は含まれない

3. **出勤状況** ❌ 不要と決定
   - 2025年8月1日の議事録にて不要と決定
   - シフト管理も対象外

### バッチ3（OP実績取得エンジン）
1. **個人別実績データ** 🟢 Excel「オペレータ実績」で取得可能
   - 内容:
     - 個人の処理件数（入力項目数）
     - 品質（ミス項目数、不読項目数）
     - 処理時間（時間(秒)）
     - 得意分野（業務ID、工程ID、作業レベル別の実績から推定可能）
   - 状況: Excel「オペレータ実績」で完全カバー可能
   - 取得方法: Excelファイルの定期取り込み

2. **配置調整履歴** ❌ データなし・今後AI運用で蓄積
   - 内容: 過去の人員変更記録とその結果
   - 状況: **石田様より「存在しない」と回答**
   - 対応: 
     - AIで配置提案後→「確定」した情報を記録（石田様提案）
     - 「配置の際の人間特有の柔軟性」取り入れ方法は今後議論予定
   - 蓄積予定項目:
     - AI提案内容
     - 管理者の確定/修正内容
     - 変更前後の配置情報
     - 変更結果の評価
     - 生産性への影響

3. **管理者ノウハウ** 📅 センター見学時に聞き取り予定
   - 内容: 
     - 判断理由・特記事項・暗黙知
     - 承認/却下の理由
   - 状況: **次回センター見学時に管理者より説明予定**
   - 対応: 
     - 管理者インタビューで収集
     - 収集した内容をRAGに取り込み
     - 運用開始後は承認/却下実績を継続的に学習

## 3. データ取得・連携方法

### 3.1 CSVファイル取得
- **現状**: 特定フォルダへの自動出力（要確認）
- **必要な対応**: 
  - 自動取得の仕組み構築
  - ファイル監視とインポート処理の自動化

### 3.2 Excelファイル取得
- **対象**: オペレータ実績.xlsx
- **取得方法**: 定期的なファイル取得（日次想定）
- **処理**: pandasでの読み込み・データベースへの格納

### 3.3 APIでのデータ取得
- **検討事項**: 既存システムとのAPI連携可否
- **代替案**: データベース直接接続またはEraX側DBへの定期取り込み

## 4. データ更新頻度と保持期間

### 4.1 更新頻度
| データ種別 | 更新頻度 | 備考 |
|-----------|---------|------|
| 配置情報 | リアルタイム（2分間隔） | CSVファイル経由 |
| 処理状況 | リアルタイム（2分間隔） | CSVファイル経由 |
| 個人別実績 | 日次 | Excelファイル経由 |
| RAG更新 | 週次 | ローカルLLMでのベクトル化負荷考慮 |

### 4.2 データ保持期間
| データ種別 | 保持期間 | 理由 |
|-----------|---------|------|
| マスタデータ | 無期限 | 基本情報のため |
| ログイン状況 | 3ヶ月 | 短期分析用 |
| 処理状況 | 6ヶ月 | 中期トレンド分析用 |
| 業務量推移 | 1年 | 年間パターン分析用 |
| 実績データ | 2年 | 長期分析・学習用 |
| AI学習データ | 無期限 | 学習品質向上のため |

## 5. 確認事項と対応状況

### 5.1 データ連携方法（石田様確認済み）
- [x] 個人別配置データの取得方法 → `KENPO_LOGINNOW_YYYYMMDD_HHMM.csv`
- [x] スキル情報の取得方法 → `oprprocessplan2.tsv`
- [ ] CSVファイルの自動出力設定
- [ ] 既存データベースへのアクセス方法

### 5.2 拠点配置ルール（現場確認必要）
- [ ] 【A工程であれば原則札幌】などの拠点別ルールの詳細
- [ ] 各拠点の内部のチーム単位で工程を寄せる配慮の必要性
- [ ] 拠点間調整時の管理者間やり取りのフロー

### 5.3 業務種別の整理（トランス・コスモス様対応中）
- [ ] 管理画面が業務ごとに分かれているため、業務一覧の整理
- [ ] 各業務の工程フローの確認

## 6. データフロー概要

```
【入力データ】
├─ CSVファイル（2分間隔）
│  ├─ KENPO_RWLOGIN_*.csv（ログイン人数）
│  ├─ KENPO_RWLOGIN_LOCATION_*.csv（拠点別配置）
│  ├─ KENPO_FS_*.csv（受付・納品件数）
│  ├─ KENPO_RWMSGCOUNT_*.csv（工程別未処理）
│  ├─ KENPO_NOTINPUT_*.csv（未投入件数）
│  └─ KENPO_LOGINNOW_YYYYMMDD_HHMM.csv（個人別配置）⭐NEW
│
├─ TSVファイル
│  └─ oprprocessplan2.tsv（スキル情報）⭐NEW
│
└─ Excelファイル（日次）
   └─ オペレータ実績.xlsx（個人実績）

【処理フロー】
├─ バッチ2（配置情報取得エンジン）
│  ├─ リアルタイムデータ収集
│  ├─ 配置状況の把握
│  └─ 最適化計算用データ準備
│
├─ バッチ3（OP実績取得エンジン）
│  ├─ 実績データ収集
│  ├─ 生産性計算
│  └─ パフォーマンス分析
│
└─ AIエンジン
   ├─ 最適化提案生成
   ├─ 管理者フィードバック収集
   └─ 学習データ蓄積
```

## 7. セキュリティ・コンプライアンス

### 7.1 個人情報の取り扱い
- オペレータ名の匿名化要否（要確認）
- アクセス権限の適切な設定
- 監査ログの記録

### 7.2 データアクセス制御
- 役割ベースのアクセス制御（RBAC）
- データの暗号化（保存時・転送時）
- 定期的なアクセスログの監査

## 8. 今後の対応予定

### Phase1（現在）
1. 必要データの取得方法確立
2. データベース設計の実装
3. 基本的な配置最適化機能の実装

### Phase2以降
1. より詳細な個人実績データの活用
2. 高度な予測モデルの実装
3. リアルタイムデータ連携の強化