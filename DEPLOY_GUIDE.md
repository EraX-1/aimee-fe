# AIMEE AWSãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰

**æœ€çµ‚æ›´æ–°**: 2025-10-24

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ãƒ‡ãƒ—ãƒ­ã‚¤

### å…¨ä½“ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰

```bash
cd /Users/umemiya/Desktop/erax/aimee-fe
./deploy-to-aws.sh
```

**æ‰€è¦æ™‚é–“**: ç´„10-15åˆ†

---

### å€‹åˆ¥ãƒ‡ãƒ—ãƒ­ã‚¤

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿
```bash
./deploy-to-aws.sh frontend
```

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿
```bash
./deploy-to-aws.sh backend
```

---

## ğŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤å†…å®¹

### è‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹å‡¦ç†

1. **SSHæ¥ç¶šç¢ºèª**
   - SSHã‚­ãƒ¼æ¨©é™è¨­å®šï¼ˆchmod 400ï¼‰
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šç¢ºèª

2. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤**
   - ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä½œæˆ
   - EC2ã¸ã®è»¢é€
   - æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠåœæ­¢
   - æ–°ã‚³ãƒ¼ãƒ‰å±•é–‹
   - docker-compose.ymlè¨­å®šï¼ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ : amd64ï¼‰
   - ã‚³ãƒ³ãƒ†ãƒŠãƒ“ãƒ«ãƒ‰ãƒ»èµ·å‹•
   - å‹•ä½œç¢ºèª

3. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤**
   - ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä½œæˆ
   - EC2ã¸ã®è»¢é€
   - æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠåœæ­¢
   - æ–°ã‚³ãƒ¼ãƒ‰å±•é–‹
   - .envè¨­å®šï¼ˆRDSæ¥ç¶šï¼‰
   - docker-compose.ymlè¨­å®šï¼ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ : amd64ï¼‰
   - å…¨ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ï¼ˆAPI, Ollama, ChromaDB, Redis, MySQLï¼‰
   - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

4. **å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ**
   - APIãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
   - ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆï¼ˆã‚¹ã‚­ãƒ«ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚°ï¼‰
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆ

---

## ğŸŒ æœ¬ç•ªç’°å¢ƒURL

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: http://43.207.175.35:8501
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API**: http://54.150.242.233:8002
- **API Docs**: http://54.150.242.233:8002/docs

---

## âš™ï¸ è¨­å®šæƒ…å ±

### EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹

| é …ç›® | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ |
|------|--------------|-------------|
| IP | 43.207.175.35 | 54.150.242.233 |
| SSHã‚­ãƒ¼ | ~/.ssh/aimee-key.pem | ~/.ssh/aimee-key.pem |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ | ubuntu | ubuntu |
| ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | ~/aimee-fe | ~/aimee-be |

### RDS MySQL
- **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: aimee-db.c96uew4c8z02.ap-northeast-1.rds.amazonaws.com:3306
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼**: admin
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: Aimee2024!RDS
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: aimee_db

---

## ğŸ“Š ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèªé …ç›®

### 1. ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ç¢ºèª

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
ssh -i ~/.ssh/aimee-key.pem ubuntu@43.207.175.35 "docker ps"

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 "docker ps"
```

### 2. ãƒ­ã‚°ç¢ºèª

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ­ã‚°
ssh -i ~/.ssh/aimee-key.pem ubuntu@43.207.175.35 \
    "docker logs aimee-frontend --tail=50"

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIãƒ­ã‚°
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker logs aimee-be-api-1 --tail=50"
```

### 3. æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl http://54.150.242.233:8002/api/v1/health

# ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
curl -X POST http://54.150.242.233:8002/api/v1/chat/message \
  -H "Content-Type: application/json" \
  -d '{"message":"SSã®æ–°SS(W)ãŒç´æœŸã‚®ãƒªã‚®ãƒªã§ã™","context":{},"session_id":"test"}'
```

### 4. ã‚¹ã‚­ãƒ«ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚°ç¢ºèª

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://43.207.175.35:8501 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ï¼š

1. ãƒãƒ£ãƒƒãƒˆç”»é¢ã§ã€ŒSSã®æ–°SS(W)ãŒç´æœŸã‚®ãƒªã‚®ãƒªã®ãŸã‚ç´æœŸ20åˆ†å‰ã«å‡¦ç†å®Œäº†ã¨ãªã‚‹ã‚ˆã†é…ç½®ã—ãŸã„ã§ã™ã€ã¨å…¥åŠ›
2. å¿œç­”ã‚’ç¢ºèªï¼š
   - âœ… ã€Œã‚¨ãƒ³ãƒˆãƒª2 â†’ ã‚¨ãƒ³ãƒˆãƒª1ã€ã®ã‚ˆã†ãªç•°ãªã‚‹å·¥ç¨‹é–“ç§»å‹•
   - âœ… ã€ŒSSã€ã®ã€Œæ–°SS(W)ã€ã®ã€ŒOCRå¯¾è±¡ã€ã®ã€Œã‚¨ãƒ³ãƒˆãƒª1ã€å½¢å¼ï¼ˆ4éšå±¤ï¼‰
   - âœ… æ‹ ç‚¹åãªã—
   - âœ… å®Ÿåè¡¨ç¤ºï¼ˆç¨²å¯¦ã€€ç™¾åˆå­ã•ã‚“ç­‰ï¼‰

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚¨ãƒ©ãƒ¼ã§åœæ­¢

**ç—‡çŠ¶**: SSHæ¥ç¶šã‚¨ãƒ©ãƒ¼
```
âŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“
```

**å¯¾å‡¦æ³•**:
```bash
# SSHã‚­ãƒ¼ç¢ºèª
ls -la ~/.ssh/aimee-key.pem

# æ‰‹å‹•æ¥ç¶šãƒ†ã‚¹ãƒˆ
ssh -i ~/.ssh/aimee-key.pem ubuntu@43.207.175.35
```

---

### ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ãªã„

**ç—‡çŠ¶**: docker psã§è¡¨ç¤ºã•ã‚Œãªã„

**å¯¾å‡¦æ³•**:
```bash
# ãƒ­ã‚°ç¢ºèª
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker logs aimee-be-api-1 --tail=100"

# æ‰‹å‹•å†èµ·å‹•
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "cd ~/aimee-be && docker-compose restart"
```

---

### APIãŒå¿œç­”ã—ãªã„

**ç—‡çŠ¶**: ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒå¤±æ•—

**å¯¾å‡¦æ³•**:
```bash
# ä¾å­˜ã‚µãƒ¼ãƒ“ã‚¹ã®ç¢ºèª
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker ps | grep aimee-be"

# Ollamaèµ·å‹•ç¢ºèª
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker exec aimee-be-ollama-main-1 ollama list"

# RDSæ¥ç¶šç¢ºèª
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker logs aimee-be-api-1 | grep -i 'database\|rds'"
```

---

## ğŸ”„ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

### æ‰‹å‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åœæ­¢
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "cd ~/aimee-be && docker-compose down"

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åœæ­¢
ssh -i ~/.ssh/aimee-key.pem ubuntu@43.207.175.35 \
    "cd ~/aimee-fe && docker-compose down"
```

---

## ğŸ“ ãƒ‡ãƒ—ãƒ­ã‚¤å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å®Ÿæ–½

- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ã§APIç²¾åº¦100%ã‚’ç¢ºèªï¼ˆ`python3 run_api_test.py`ï¼‰
- [ ] ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒèµ·å‹•ã—ã¦ã„ã‚‹
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒèµ·å‹•ã—ã¦ã„ã‚‹
- [ ] ã‚¹ã‚­ãƒ«ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚°ãŒå‹•ä½œã—ã¦ã„ã‚‹

### ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿæ–½

- [ ] `./deploy-to-aws.sh` ã‚’å®Ÿè¡Œ
- [ ] ã‚¨ãƒ©ãƒ¼ãªãå®Œäº†ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] æœ¬ç•ªç’°å¢ƒURLã«ã‚¢ã‚¯ã‚»ã‚¹
- [ ] ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ

---

## ğŸ¯ ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèªãƒã‚¤ãƒ³ãƒˆ

### å¿…é ˆç¢ºèªäº‹é …

1. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**
   - [ ] http://43.207.175.35:8501 ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
   - [ ] ãƒãƒ£ãƒƒãƒˆç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹

2. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**
   - [ ] http://54.150.242.233:8002/api/v1/health ãŒ "healthy"
   - [ ] http://54.150.242.233:8002/docs ã§APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹

3. **ã‚¹ã‚­ãƒ«ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚°**
   - [ ] ç•°ãªã‚‹å·¥ç¨‹é–“ç§»å‹•ãŒææ¡ˆã•ã‚Œã‚‹ï¼ˆã‚¨ãƒ³ãƒˆãƒª2 â†’ ã‚¨ãƒ³ãƒˆãƒª1ï¼‰
   - [ ] 4éšå±¤ã®ã¿ã®è¡¨è¨˜ï¼ˆæ‹ ç‚¹åãªã—ï¼‰
   - [ ] å®ŸåãŒè¡¨ç¤ºã•ã‚Œã‚‹

4. **å…¨ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•**
   - [ ] APIï¼ˆFastAPIï¼‰
   - [ ] Ollama Lightï¼ˆqwen2:0.5bï¼‰
   - [ ] Ollama Mainï¼ˆgemma2:2b, gemma3:4bï¼‰
   - [ ] ChromaDB
   - [ ] Redis
   - [ ] MySQL

---

## ğŸ’¡ Tips

### ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ã®ç›®å®‰
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿: ç´„5åˆ†
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿: ç´„10åˆ†
- å…¨ä½“: ç´„15åˆ†

### ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ

```bash
# ãƒ­ã‚°ã‚’è¦‹ãªãŒã‚‰å®Ÿè¡Œ
./deploy-to-aws.sh 2>&1 | tee deploy.log

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œ
nohup ./deploy-to-aws.sh > deploy.log 2>&1 &
```

### ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
git checkout main
./deploy-to-aws.sh

# ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
git checkout <commit-hash>
./deploy-to-aws.sh
git checkout main  # æˆ»ã™
```

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### ãƒ­ã‚°åé›†ã‚³ãƒãƒ³ãƒ‰

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ­ã‚°ã‚’åé›†ï¼š

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ­ã‚°
ssh -i ~/.ssh/aimee-key.pem ubuntu@43.207.175.35 \
    "docker logs aimee-frontend --tail=200" > frontend.log

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIãƒ­ã‚°
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker logs aimee-be-api-1 --tail=200" > backend-api.log

# å…¨ã‚³ãƒ³ãƒ†ãƒŠçŠ¶æ…‹
ssh -i ~/.ssh/aimee-key.pem ubuntu@54.150.242.233 \
    "docker ps -a" > containers.log
```

---

**æœ€çµ‚æ›´æ–°**: 2025-10-24
